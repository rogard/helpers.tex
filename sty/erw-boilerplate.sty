% -----------------------------------------------------------------
% Copyright (C) 2025-2026 by Erwann Rogard
% - Source repository: https://github.com/rogard/helpers.tex
% - Released under the LaTeX Project Public License v1.3c or later
% - See http://www.latex-project.org/lppl.txt
% -----------------------------------------------------------------

\ProvidesExplPackage{erw-boilerplate}{2025/12/21}{1.0}
{ Standalone expl3-like commands for use in implementations }

% -----------------------------------------------------------------
% integer
\cs_new:Npn
\__erw_int_last:nn
#1 % <first>
#2 % <count>
{ \int_eval:n{#1+#2-1} }
% -----------------------------------------------------------------
% function
\cs_new:Npn
\__erw_parameter_braced:n
#1 % <index>
{ \exp_not:n{ {## #1} } }
\cs_new:Npn
\__erw_parameter_braced:nn
#1 % <first>
#2 % <last>
{ \int_step_function:nnN {#1}{#2}\__erw_parameter_braced:n }
\cs_generate_variant:Nn\__erw_parameter_braced:nn{ne}
% boilerplate
\cs_new_protected:Npn
\__erw_inline:nn
#1 % <arg spec>
#2 % <code>
{
  \cs_gset:cn{__erw_lambda:#1}{#2}
  \use:c{__erw_lambda:#1}
}
% Example:
% \__erw_inline:nn{n}{Hello~#1!}{world}
\cs_new_protected:Npn
\__erw_scope_infix_type:nNN
#1 % <input>
#2 % <output>
#3 % <regex>
{
  \seq_set_regex_extract_once:NNn
  #2
  #3
  { #1 }
}
\cs_new_protected:Npn
\__erw_scope_infix_type:NNN
#1 % <input>
#2 % <output>
#3 % <regex>
{
  \exp_args:Ne
  \__erw_scope_infix_type:nNN
  { \cs_to_str:N #1 }
  #2#3
  % Example:
  % \__erw_scope_infix_type:NN
  % \l__foo_str
  % \l_tmpa_seq
  % \exp_args:Ne\tl_show:n{
  % Scope: \seq_item:Nn\l_tmpa_seq{ 2 } % l
  % Infix: \seq_item:Nn\l_tmpa_seq{ 3 } % foo
  % Type: \seq_item:Nn\l_tmpa_seq{ 4 } % str
  % }
}
% -----------------------------------------------------------------
% clist
\cs_new_protected:Npn
\__erw_clist_sort_in_place:N
#1 % <clist>
{
  \clist_sort:Nn#1
  {
    \str_compare:nNnTF { ##1 } < { ##2 }
    { \sort_return_same: }
    { \sort_return_swapped: }
  }
}
\prg_new_protected_conditional:Npnn
\__erw_clist_if_subset:NN #1#2 { TF }
{
  \clist_map_inline:Nn #1
  {
    \clist_if_in:NnF #2 { ##1 }
    { \prg_return_false: }
  }
  \prg_return_true:
}
