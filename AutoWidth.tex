%------------------------------------------------------------
% Source:
%       https://github.com/rogard/helpers.tex
% Usage:
%       \input{AutoWidth}
%       \AutoWidth[r]{<text>}
%       \AutoWidthAlignRightHelper< <relative width> >[r]{<text>}
% Note:
%       Frame added in draft mode
% ------------------------------------------------------------
%\documentclass[draft]{report} % TEST
\usepackage{ifdraft} 
\usepackage{etoolbox}
\usepackage{xparse}
%\usepackage{zebra-goodies}

\ExplSyntaxOn
\ifcsundef{AutoWidthFlag}
{

\cs_new_protected:Npn \__erw_autowidth_open:n #1
{%\todo{Check that #1 in \{l,c,r\}}%
  \begin{tabular}{@{}#1@{}}%
}

\cs_new_protected:Npn \__erw_autowidth_rest:n #1
{#1\end{tabular}}

% <--- \todo separate helper

\cs_new_protected:Nn \__erw_ifboolean_apply:nnn 
{ 
    \IfBooleanTF{#1}{#2{#3}}{#3}
}   

\cs_new_protected:Nn \__erw_autowidth:nn
{
  \__erw_autowidth_open:n{#1}
  \__erw_autowidth_rest:n{#2}
}

% --->

\NewDocumentCommand{\AutoWidth}
{
  O{l}  % align
  +m    % text
}
{%
  \ifdraft
  {%
    \frame{%
     \__erw_autowidth:nn{#1}{#2}
    }
  }
  {\__erw_autowidth:nn{#1}{#2}}
}


\NewDocumentCommand{\AutoWidthAlignRightHelper}{D<>{0.8} O{l} +m}
{%
  \noindent\makebox[#1\textwidth][r]
  {%
      \AutoWidth[#2]{#3}
  }
}

  \def\AutoWidthFlag{}

}
{
  % do nothing
}

\ExplSyntaxOff

%\begin{document} % TEST
%
%\AutoWidth{curiosity\\killed\\the cat}  % TEST
%
%\AutoWidth[r]{curiosity\\killed\\the cat}  % TEST
%
%\end{document} % TEST